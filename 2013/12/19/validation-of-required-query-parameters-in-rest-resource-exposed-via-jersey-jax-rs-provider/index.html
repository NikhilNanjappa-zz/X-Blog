<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Validation Of Required Query Parameters In Rest Resource Exposed Via Jersey Jax Rs Provider - Xebia Blog</title>

    <link rel="canonical" href="http://blog.xebia.in/2013/12/19/validation-of-required-query-parameters-in-rest-resource-exposed-via-jersey-jax-rs-provider/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Validation Of Required Query Parameters In Rest Resource Exposed Via Jersey Jax Rs Provider</h1>
                    
                    <span class="meta">Posted by swatijain85 on December 19, 2013</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        <div class="row">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=shekhargulati" async="async"></script>

            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <h4>Reading time about 3  minutes</h4>

              <h1>Validation of Required Query Parameters in REST Resource (exposed via Jersey JAX-RS provider)</h1>

<p>Recently, I had exposed my application resources on web via JAX-RS Jersey provider - so that it can be consumed as a Restful Web service. Thereafter, I got a new request from client which is stated below:</p>

<p>&quot;<em><strong>Query parameters that are required to invoke any operation on rest resource shall be validated for its existence and expected pattern value in request (in JSON format) before resource method is actually invoked</strong></em>&quot;</p>

<p>i.e. my web service (resource) methods shall return results only when they are properly invoked with all the mandatory parameters and that too when their value matches the expected pattern value.</p>

<p>To implement the above request, initially I thought that if any required query parameter is not supplied in request, then its value shall be NULL and my resource class (or method - to be more specific) should deal with it accordingly. But as I implemented above thought in the code, I realized that above statement is not completely true as the value for missing query parameters is not always NULL, it is an empty collection for List or Set and default Java value for primitive types (as specified in JAX-RS 1.0 specification).</p>

<p>Adding @DefaultValue annotation and setting the parameter to an appropriate value whenever it&#39;s missing was also an option but that was also ruled out because it is always not possible to define the default value. Also, I had to write code to validate the passed in value for each query parameter in my resource method so that it matched the expected pattern value. Implementing such kind of validation at each resource method would be cumbersome and hard to manage as it may lead to boiler plate code problem.</p>

<p>After much thought process and brain storming session, I decided to implement above validation in a generic way. Firstly, I created an name-binding annotation as mentioned below:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> @NameBinding @Retention(RetentionPolicy.RUNTIME) public @interface ValidateQueryParams { public abstract String[] value(); } 
</code></pre></div>
<p>@ValidateQueryParams annotation&#39;s value is the array of query parameters that need be validated for its existence in request along with expected value pattern (as defined by standard regular expression). The name of query parameter and its expected value pattern are separated by &#39;:&#39;</p>

<p>Above annotation is used on resource method in following manner:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> @POST @Consumes(MediaType.APPLICATION_JSON) @Produces(MediaType.APPLICATION_JSON) @ValidateQueryParams({&quot;id:[0-9]+&quot;, &quot;version:[0-9]+&quot;}) public Response getEntity(@Context UriInfo ui, @Context HttpHeaders hh, String data); 
</code></pre></div>
<p>Above definition means that before invoking my resource method &quot;getEntity&quot;, I need to check for presence of following query parameters in request:</p>

<ul>
<li>Parameter &#39;id&#39; which shall contain only numeric value as specified by regex pattern [0 -9]+</li>
<li>Parameter &#39;version&#39; which shall also contain only numeric value as specified by regex pattern [0 -9]+</li>
</ul>

<p>If any of the above query parameters are not present in my request or its value doesn’t match the specified regex pattern, the application shall throw BAD_REQUEST exception.</p>

<p>Thereafter, I created a new filter that was bound to this annotation in following manner:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> /__ _ Filter to perform request parameters validation on REST resource _ _ _/ @Provider @ValidateQueryParams(&quot;&quot;) public class ValidationFilter implements ContainerRequestFilter { @Override public void filter(ContainerRequestContext requestContext) { try { validateQueryParams(requestContext); } catch (Exception e) { throw new WebApplicationException(Status.BAD_REQUEST); } }

... ... 
</code></pre></div>
<p>All the code for validating the query parameters present in request is now implemented in above filter. For reader reference, query parameters map can be retrieved from ContainerRequestContext object in following manner (inside request filter):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> MultivaluedMap&lt;String, String&gt; requestQueryParamMap = requestContext.getUriInfo().getQueryParameters(); 
</code></pre></div>
<p>Now, there is a common place where I need to write the code for validating the query parameters - where I check for their existence and if the supplied value matches the expected pattern value or not. If the validation fails, then I just throw BAD_REQUEST exception. I&#39;ve attached the sample code for creating such filter with this blog <a href="http://xebee.xebia.in/wp-content/uploads/2013/12/ValidationFilter.java_.txt">ValidationFilter.java</a>. Since, this validation filter is called before any resource method is invoked, so it served my use case to perfection. Finally, all is well now :).</p>

<p>Happy Reading!</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2013/12/18/handcuff-the-culprit-sqls-in-your-application/" data-toggle="tooltip" data-placement="top" title="Handcuff The Culprit Sqls In Your Application">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2013/12/27/challenges-in-gui-automation/" data-toggle="tooltip" data-placement="top" title="Challenges In Gui Automation">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58958750-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
