<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Rich Ui Interactions The Easy Way Backbone Js - Xebia Blog</title>

    <link rel="canonical" href="http://blog.xebia.in/2012/06/12/rich-ui-interactions-the-easy-way-backbone-js/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="http://xebia.com/" target="_blank">Xebia</a>
                </li>
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Rich Ui Interactions The Easy Way Backbone Js</h1>
                    
                    <span class="meta">Posted by kgujral on June 12, 2012</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        <div class="row">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=shekhargulati" async="async"></script>

            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <h4>Reading time about 4  minutes</h4>

              <h1>Rich UI interactions the easy way -- BackBone.js</h1>

<p>During the past few weeks I&#39;ve been looking into a lot of javascript based UI frameworks and thats when I discovered &quot;Backbone.js&quot;.</p>

<p>Backbone.js basically is a MVC (Model View Collections) based framework for client side scripting. In a nutshell a Model represents a domain object. A Collection is a set of models. And a View governs how to display a particular model or collection and also when to refresh the view as and when the models or collections change.</p>

<p>I developed a very simple application which shows the tweets of <strong>@XebiaIndia</strong> in an infinite scrolling view (as seen on facebook or twitter as we keep scrolling the page, new feeds keep on loading). <em>*<em>Here is the link to the demo application : *</em></em><a href="http://kgujral-backbone.appspot.com/">http://kgujral-backbone.appspot.com/</a></p>

<p>Lets get started and try to understand the code.</p>

<p>Here is the index.html file (landing page):</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> &lt;html&gt; &lt;head&gt; &lt;link type=&quot;text/css&quot; rel=&quot;stylesheet&quot; href=&quot;css/main.css&quot;&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;js/libs/jquery.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;js/libs/jquery-tmpl.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;js/libs/underscore.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;js/libs/backbone.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot; src=&quot;js/app.js&quot;&gt;&lt;/script&gt; &lt;title&gt;Infinite Scroll View -- BackBone.js&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Infinite Scroll View -- BackBone.js&lt;/h1&gt; &lt;h3&gt;Tweets from @XebiaIndia&lt;/h3&gt; &lt;div id=&quot;tweets&quot;&gt; &lt;/div&gt; &lt;div id=&quot;footer&quot;&gt;Please scroll down inside the upper div to load more tweets&lt;/div&gt;

&lt;!-- Template definition for displaying tweets --&gt; &lt;script id=&quot;tweet-tmpl&quot; type=&quot;text/x-jquery-tmpl&quot;&gt; &lt;div class = &quot;post&quot;&gt; &lt;img class = &quot;img&quot; src = &quot;${user.profile_image_url}&quot; /&gt; &lt;span class = &quot;text&quot;&gt;${text}&lt;/span&gt; &lt;/div&gt;     &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; 
</code></pre></div>
<p><strong>Javascript libraries used and their significance</strong></p>

<ul>
<li><strong><em>jquery.js</em></strong> for we cannot work without it !</li>
<li><em><strong>jquery-tmpl.js</strong></em> is a library to create HTML Templates and render them with JSON data.</li>
<li><em><strong>underscore.js</strong></em> : backbone.js has a hard dependency on this. It contains a lot of utility functions.</li>
<li><em><strong>backbone.js</strong></em> : For the MVC support.</li>
<li><em>*<em>app.js *</em></em>: This js file contains all the view and collection definitions and also defines an entry point for the app.  (For the ease of understanding the example I wrote all the view and collection definitions in one js file; but its recommended to keep each Model, View and collection definition in different js files)</li>
</ul>

<p>Lets understand the app.js file now one part at a time :</p>

<p><strong>Collection definition:</strong></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> var Tweets = Backbone.Collection.extend({ url : function() { return &quot;tweets/&quot;+this.page; }, nextPage : function() { this.page++; }, page : 1 }); 
</code></pre></div>
<ul>
<li>The <em>*<em>url *</em></em>property of the Tweets collections defines which URL to hit whenever the collection needs to create, read, update, delete the data inside it. Using this URL property, Backbone automatically creates the corresponding POST, GET, PUT, DELETE request to the server.</li>
<li>The <em>*<em>nextPage *</em></em>property simply defines the logic to move to the next page.</li>
<li>The <em>*<em>page *</em></em>property holds the current page number to load.
<strong>View definition:</strong></li>
</ul>
<div class="highlight"><pre><code class="language-text" data-lang="text"> var ScrollView = Backbone.View.extend({ el : $(&#39;#tweets&#39;), events : { &#39;scroll&#39; : &#39;scrollEvent&#39; },


    initialize : function(options) {
        this.template = options.template;
        _.bindAll(this, &#39;render&#39;, &#39;getTweets&#39;, &#39;scrollEvent&#39;);
        this.scrollTopPrev = this.el.scrollTop;
        this.tweetCollection = new Tweets();
        this.tweetCollection.bind(&#39;reset&#39;, this.render);
        this.isLoading = false;
        this.getTweets();
    },

    render : function() {
        var template = $(this.template);
        var html = template.tmpl(this.tweetCollection.toJSON());
        $(this.el).append(html);
        this.isLoading = false;
    },

    getTweets : function() {
        this.isLoading = true;
        this.tweetCollection.fetch();
    },

    scrollEvent : function() {
        var offset = 300;
        if (!this.isLoading
            &amp;amp;&amp;amp; (this.scrollTopPrev &amp;lt; this.el.scrollTop) &amp;amp;&amp;amp; ($(this.el).height() + this.el.scrollTop + offset &amp;gt;= this.el.scrollHeight)) {
            this.tweetCollection.nextPage();
            this.getTweets();
        }
        this.scrollTopPrev = this.el.scrollTop;
    }


}); 
</code></pre></div>
<ul>
<li>The <em>*<em>el *</em></em>property defines the parent or the container tag on which all the DOM manipulations and event listening takes place.</li>
<li>The <em>*<em>initialize *</em></em>property is like a constructor of the view. All the required properties like the collection, the template element  etc. are being initialized here. The initial loading of tweets is also taking place here. Another notable thing here is <em>this.tweetCollection.bind(&#39;reset&#39;, this.render);</em> This is an in-built feature of backbone.js which triggers the &#39;reset&#39; event of any collection (tweetCollection in this case) whenever we load new results into it and binds the callback to the 2nd parameter i.e. <em>this.render</em> method contained within this view. Thus instead of getting confused between callbacks we can write very manageable and easy to understand code by just responding to events.</li>
<li>The <em>*<em>render *</em></em>property just reads the jquery template and renders it with the collection data to create the actual DOM structure of tweets which is visible to the user.</li>
<li>The <em>*<em>getTweets *</em></em>property fetches the next page of tweets and it internally fires the &#39;reset&#39; event and hence the new data is again rendered onto the view.</li>
<li>The <em>*<em>scrollEvent *</em></em>property checks if the scroll has reached to the bottom of the container and loads new tweets accordingly.</li>
</ul>

<p><strong>Finally the code in app.js that acts as the entry point:</strong></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> $(document).ready(function(){ var scrollView = new ScrollView({ template : &quot;#tweet-tmpl&quot; }); }); 
</code></pre></div>
<p>When the DOM is loaded, it just creates an object of the View we created above and provides it with the Template <em>#tweet-tmpl</em> which was already created the home.html file.</p>

<p><strong>Below is the back-end code written using Spring which needs no explanation:</strong></p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> @RequestMapping(value = &quot;/tweets/{page}&quot;, method = RequestMethod.GET) public @ResponseBody String getTweetsByPage(@PathVariable int page) { RestTemplate rt = new RestTemplate(); String tweetJson = rt.getForObject(&quot;https://api.twitter.com/1/statuses/user_timeline.json?&quot; \+ &quot;screen_name=XebiaIndia&amp;count=10&amp;page=&quot; \+ page, String.class); return tweetJson; } 
</code></pre></div>
<p><strong>Conclusion</strong></p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2012/06/06/quick-start-with-automated-functional-testing-of-grails-application/" data-toggle="tooltip" data-placement="top" title="Quick Start With Automated Functional Testing Of Grails Application">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2012/06/15/create-update-and-delete-jobs-dynamically-in-quartz/" data-toggle="tooltip" data-placement="top" title="Create Update And Delete Jobs Dynamically In Quartz">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; <a href="http://xebia.com/" target="_blank">Xebia</a> 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58958750-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
