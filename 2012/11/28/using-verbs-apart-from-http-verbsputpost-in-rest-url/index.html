<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Using Verbs Apart From Http Verbsputpost In Rest Url - Xebia Blog</title>

    <link rel="canonical" href="http://blog.xebia.in/2012/11/28/using-verbs-apart-from-http-verbsputpost-in-rest-url/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Using Verbs Apart From Http Verbsputpost In Rest Url</h1>
                    
                    <span class="meta">Posted by anirudh.xebia on November 28, 2012</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        <div class="row">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=shekhargulati" async="async"></script>

            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <h4>Reading time about 4  minutes</h4>

              <h1>Using verbs apart from HTTP verbs(PUT/POST..) in REST URL</h1>

<p>As per REST, the URLs should make use of HTTP verbs to expose their REST based services via HTTP. (i.e GET/PUT/POST/DELETE) </p>

<p>So, a resource would be something like </p>

<p>[sourcecode language=&quot;java&quot;] GET ../foods/1 would get you the food with id 1. PUT ../foods/2 would update the food with id 2. POST ../foods will add a new food. DELETE ../foods/1 will delete the food resource with id 1.</span> 
```</p>

<p>But in a real life complex application, we are faced with exposing many services such as approve, reject where it becomes inevitable to add verbs to the URL. What should we do? Should we just have the URLs like ../foods/1/approve ? </p>

<p>What would go wrong if we use verbs in REST URL. Whether there is some rationale behind it or it just REST dogma.. ** Apparently, there is** :</p>

<p>To understand, we would need to get into the details of HTTP and understand how we could make use of browser capabilities (caching..) which are made in consideration with <a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html">HTTP specifications</a>.</p>

<p><strong>1.  GET :</strong> As per the specification ; HTTP GET command should not change the state of the resource. It means that HTTP GET command has to be with no side effect, suppose we want to do a </p>

<p>GET on /approve and then return a boolean which would return success/false.</p>

<p>It would be incorrect as it is changing the state of resource on which approve is called.</p>

<p>HTTP GET is cached by the browser and many other proxy servers like <a href="http://en.wikipedia.org/wiki/Content_delivery_network">CDNs</a>. (provided some conditions as per HTTP specifications are met.) </p>

<p>And in order to leverage these caching capabilities HTTP specifications must be adhered. </p>

<p> </p>

<p><strong>2. PUT :</strong> The specification says that apart from POST all HTTP verbs have to be idempotent.</p>

<p>Idempotent means that the result of the action is independent of the number of times it is executed; i.e a request sent n number of times would still return the same result. So if a browser is unable to complete a PUT request or does not get back acknowledgement it safely resends the request again and again, without worrying. </p>

<p>If we have a verb in a URL like /increment or /run or /stop ; executing them again and again will not result in the same result; (they might as well return an error.) (try running startup.sh on a running tomcat )</p>

<p>In case there is an issue with concurrent modification of the resource and there is a fear that the cached GET response is stale or might have got changed by some other thread, HTTP lays down the specification for conditional PUTs and POSTs with the help of HTTP header tags.(<a href="http://en.wikipedia.org/wiki/HTTP_ETag">ETag)</a></p>

<p> </p>

<p><strong>3. POST :</strong> we could do a POST on a verb, it will not harm anything. But, It would be not self explanatory and would defeat the whole purpose of simple,self explanatory REST urls.</p>

<p> </p>

<p><strong>4. DELETE:</strong> this would not make any sense on /increment or ../start</p>

<p>*<em>5. *</em>Also, when if we have verbs different from HTTP verbs we would be removing the intuitiveness of the URL , 2 verbs in a URL certainly looks ambiguous.</p>

<p>So, still if we get stuck in a situation where we have to use a verb, what could be our options. Below are the alternatives :</p>

<p><strong>1.</strong> Use a &quot;method&quot; Query param - Use a Query param method=approve So our approach would be:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> PUT .../foods/1/?method=approve&amp;user=10134 
</code></pre></div>
<p>(flicker uses this approach ;example http://api.flickr.com/services/rest/?method=flickr.test.echo&amp;name=value.)</p>

<p><strong>2. </strong>Send a JSON Form object</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> POST .../foods/1 JSON: {method:approve} 
</code></pre></div>
<p><strong>3.</strong> Use noun instead of verb. Instead of using verb &quot;approve&quot; we would use the noun &quot;approval&quot; and make this a domain object. The approval would have association with the domain objects which are required to be approved.</p>

<p>for example, to approve a food, we would have two additional domain objects.</p>

<p>    1. ApprovalRequest     2. Approval (or Approved)</p>

<p>To submit a food for approval We would do:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> POST ../foods/1/approvalRequests -- &gt;foodId :1 is added into ApprovalRequest 
</code></pre></div>
<p>To approve this food, we would do</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> POST ../foods/1/approval -- &gt; foodId :1 is added to Approval The flow hence becomes , Food --- &gt; ApprovalRequest ---&gt; Approval GET on ../foods/approval will give all approved foods and a GET on ../foods/approvalRequests will give all pending foods. doing a DELETE ../foods/1/approvalRequests -- &gt;will reject the food. 
</code></pre></div>
<p>(This is how facebook handles the states of friend requests.) </p>

<p>So, the basic idea is to model in such a way that all our verbs become states if want them to be exposed via HTTP. This looks a very RESTful and neat approach.</p>

<h2>Comments</h2>

<p><strong><a href="#9300" title="2012-11-29 14:57:51">Vijay Rawat</a>:</strong> Good blog. Please share code for ApprovalRequest and Approval. (If possible). Thanks.</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2012/11/05/mouse-movements-in-webdriver/" data-toggle="tooltip" data-placement="top" title="Mouse Movements In Webdriver">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2012/12/04/hive-an-introduction/" data-toggle="tooltip" data-placement="top" title="Hive An Introduction">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
