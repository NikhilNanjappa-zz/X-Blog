<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Android Content Providers - Xebia Blog</title>

    <link rel="canonical" href="http://xebia.com/2010/08/18/android-content-providers/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Android Content Providers</h1>
                    
                    <span class="meta">Posted by pranjan on August 18, 2010</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Android Content Providers</h1>

<p>The database in an Android application is available only to the application which created it. In normal scenarios, applications need to share data quiet frequently. There is a concept of content provider  in Android which can be used to share data between different applications. The content provider is a type of data store which has an URI. This URI is the signature of the content providers. The URI is used to get the handle to the content provider and perform operations on it.</p>

<p>Android comes with several in built content providers like call log info, contacts, medial files etc which provide information about the calls, the contacts and the media files stored. Each is having a URI through which the data inside them can be accessed.</p>

<p>You can also create your own content providers and assign an URI to it.  In this blog, we will create our own content provider and use it to insert/access data in/from it.</p>

<p>First of all we need to create a class which extends the ContentProvider class provided by Android.</p>

<p>[sourcecode language=&quot;java&quot;] public class AddressProvider extends ContentProvider {</p>

<p>public static final Uri CONTENT_URI = Uri.parse(&quot;content://com.example.AddressProvider&quot;);</p>

<p>private SQLiteDatabase db; private String DATABASE_TABLE = &quot;address&quot;;</p>

<p>@Override public boolean onCreate() { DatabaseHelper dbHelper = new DatabaseHelper(getContext()); db = dbHelper.getWritableDatabase(); return (db == null) ? false : true; } ... } [/sourcecode]</p>

<p>Here we have extended the ContentProvider class and added instance variables for using database, and an URI which is the URI of the content provider. Then we have overridden the onCreate() to initialize the SQLiteDatabase db using DatabaseHelper which was created in my <a href="http://xebee.xebia.in/2010/08/16/database-implementation-in-android/">previous post about Android databases</a>.</p>

<p>The ContentProvider is an abstract class and subclassing it needs implementation for these five methods</p>

<p>getType() onCreate() query() insert() delete() update()</p>

<p>Implement all methods by the default implementation given by Eclipse(or other IDE). Then we will change the implementation for insert() and query(). insert() is used to insert record and query() is used to fetch data.</p>

<p>[sourcecode language=&quot;java&quot;] @Override public Uri insert(Uri uri, ContentValues values) {</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">  long rowID = db.insert(DATABASE_TABLE, &amp;quot;&amp;quot;, values);

  if (rowID &amp;gt; 0) {
       Uri _uri = ContentUris.withAppendedId(CONTENT_URI, rowID);
       getContext().getContentResolver().notifyChange(_uri, null);
       return _uri;
  }
  throw new SQLException(&amp;quot;Failed to insert row into &amp;quot; + uri);
</code></pre></div>
<p>}</p>

<p>@Override public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) { String[] columns = new String[] { “id”, “city”, “street”, “country”}; return db.query(DATABASE_TABLE, columns, null, null, null, null, null); } [/sourcecode]</p>

<p>The implementation of insert() and delete simply uses the db instantiated in onCreate() to insert/fetch the record. The insert() then notifies other users using the content provider about the insertion of a row in the table.</p>

<p>This content provider resembles a service in Service Oriented Architecture(SOA). For this we need to change the AndroidManifest.xml. This is just like publishing an wsdl for web services. Add the content provider as a provider in AndroidManifest.xml.</p>

<p>[sourcecode language=&quot;xml&quot;] <application android:icon="@drawable/icon" android:label="@string/app_name"> <activity android:name=".AddressProviderActivity" android:label="@string/app_name1"> ... </activity> <provider android:name="AddressProvider" android:authorities="com.example.AddressProvider" /> </application> [/sourcecode]</p>

<p>Suppose any Activity wants to access the address db through this service provider. The Activity can use getContentResolver() method to get the handle to the provider. To insert a row from an activtiy we just need to call the insert() using getContentResolver().</p>

<p>[sourcecode language=&quot;java&quot;] private void insert(AddressDAO addressDAO) { ContentValues values = new ContentValues(); values.put(&quot;city&quot;, &quot;Gurgaon&quot;); values.put(&quot;street&quot;, &quot;sector 14&quot;); values.put(&quot;country&quot;, &quot;India&quot;); getContentResolver().insert(AddressProvider.CONTENT_URI, values); } [/sourcecode]</p>

<p>Same is the case for fetching the data.</p>

<p>[sourcecode language=&quot;java&quot;] private void get(AddressDAO addressDAO) { Cursor c = getContentResolver().query(AddressProvider.CONTENT<em>URI, null, null, null, null); if (c.moveToFirst()) DisplayAddress(c); else Toast.makeText(this, &quot;No address found&quot;, Toast.LENGTH</em>LONG).show(); }</p>

<p>public void DisplayAddress(Cursor c) { final EditText editText = (EditText) findViewById(R.id.EditText01); editText.setText(new String(c.getString(2))); Toast.makeText(this, &quot;id: &quot; + c.getString(0) + &quot;\n&quot; + &quot;ISBN: &quot; + c.getString(1) + &quot;\n&quot; + &quot;TITLE: &quot; + c.getString(2) + &quot;\n&quot; + &quot;PUBLISHER: &quot;+ c.getString(3), Toast.LENGTH_LONG).show(); } [/sourcecode]</p>

<h2>Comments</h2>

<p><strong><a href="#3074" title="2010-10-28 10:44:45">Paritosh Ranjan</a>:</strong> The open method was a utilitiy created in AddressDAO. DatabaseHelper extends SQLiteOpenHelper which has a method getWritableDatabase().</p>

<p><strong><a href="#3069" title="2010-10-27 17:02:05">Sandeep</a>:</strong> /* public boolean onCreate() { 10 DatabaseHelper dbHelper = new DatabaseHelper(getContext()); 11 db = dbHelper.getWritableDatabase(); 12 return (db == null) ? false : true; 13 } */ Change the line number 11. call dbHelper.open() instead of dbHelper.getWritableDatabase()</p>

<p><strong><a href="#6159" title="2011-11-09 16:26:59">Rob Miles</a>:</strong> Hey Paritosh Ranjan, this is great article thanks for sharing with us. here is another nice article on content provider in android application.... http://mindstick.com/Articles/70072812-e6d0-41e4-89ab-da670d747a44/?Content%20Provider%20in%20Android which explain very nice. Thanks!!</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2010/08/17/performace-testing-made-easy-using-badboy-and-jmeter/" data-toggle="tooltip" data-placement="top" title="Performace Testing Made Easy Using Badboy And Jmeter">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2010/08/27/integrating-spring-3-with-jpa-2/" data-toggle="tooltip" data-placement="top" title="Integrating Spring 3 With Jpa 2">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
