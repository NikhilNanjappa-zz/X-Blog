<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Spring Android Spring For Android - Xebia Blog</title>

    <link rel="canonical" href="http://blog.xebia.in/2010/12/31/spring-android-spring-for-android/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Spring Android Spring For Android</h1>
                    
                    <span class="meta">Posted by ykapoor on December 31, 2010</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        <div class="row">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=shekhargulati" async="async"></script>

            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <h4>Reading time about 9  minutes</h4>

              <h1>Spring-Android: Spring for Android!!!</h1>

<p>With an aim to ease the development of android applications <a href="http://www.springsource.org/spring-android">Spring-Android</a>, an extension to Spring framework is released.The framework with it&#39;s first release brings in RestTemplate and commons-logging support for the Android based applications.</p>

<p>This blog is the result of my experience while using the Spring-Android framework in one of the android applications that I am currently working on.This post mainly focuses on the steps involved to get it working.</p>

<p>The sample Webservice in this scenario has a method defined to handle GET requests that return all the Projects presently configured along with certain details and an array of issues. The class is as below:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> public class Project { private String name; private Integer id; private String owner; private Issue[] issues; … //getter and setters for all … } 
</code></pre></div>
<p>On a Web-service <em>GET</em> request, the project data is retrieved in JSON representation. A request to get all projects configured in the system gets back with the response below: </p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> [{&quot;class&quot;:&quot;com.xyz.Project&quot;,&quot;id&quot;:1,&quot;issues&quot;:[],&quot;name&quot;:&quot;TestProject0&quot;,&quot;owner&quot;:&quot;Test0&quot;}, {&quot;class&quot;:&quot;com.xyz.Project&quot;,&quot;id&quot;:2,&quot;issues&quot;:[],&quot;name&quot;:&quot;TestProject1&quot;,&quot;owner&quot;:&quot;Test1&quot;}, {&quot;class&quot;:&quot;com.xyz.Project&quot;,&quot;id&quot;:3,&quot;issues&quot;:[],&quot;name&quot;:&quot;TestProject2&quot;,&quot;owner&quot;:&quot;Test2&quot;}] 
</code></pre></div>
<p>That completes the Rest service scenario description. Now let&#39;s find out how to access it in an Android application using Spring-Android&#39;s RestTemplate.</p>

<p>With my basic eclipse Android project already in place, I just created a lib folder so as to include Spring-Android&#39;s jar. You can download the jar files from <a href="http://www.springsource.com/download/community">here</a></p>

<p>Specifically, I have included spring-android-rest-template-1.0.0.M1.jar and spring-android-commons-logging-1.0.0.M1.jar. Apart from these two, we need to have commons-httpclient 3.x jar. This jar is required for using Spring-Android&#39;s RestTemplate. Android supports commons-httpclient 4.x. and Spring-Android&#39;s RestTemplate may support this in future.</p>

<p>Please note that we have to <strong>include the Jars from the lib folder to the Project&#39;s class path</strong> for the Dex compilation process.</p>

<p>Now, with the basic setup done, let&#39;s move over to our simple Android Activity that makes use of the Spring-Android&#39;s RestTemplate.</p>

<p>[sourcecode language=&quot;java&quot; highlight=&quot;7,8,9,10&quot;] public class DefaultActivity extends Activity { /*_ Called when the activity is first created. _/ @Override public void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState);</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">RestTemplate restTemplate = new RestTemplate();
restTemplate.setRequestFactory(new CommonsClientHttpRequestFactory());
String url = &amp;quot;http://192.168.1.146:8080/grailsRestWS/project/&amp;quot;;
String data = restTemplate.getForObject(url, String.class);
setContentView(R.layout.main);
}
</code></pre></div>
<p>[/sourcecode]</p>

<p>Let&#39;s try to understand the code given above</p>

<p><strong>Line 7:</strong> It creates a restTemplate object. The RestTemplate aides Restful communication with the HTTP servers.</p>

<p><strong>Line 8:</strong> The restTemplate is assigned a requestFactory. RequestFactory is used for creating HttpClientRequest representing a client side http request.</p>

<p><strong>Line 9:</strong> The url used is not localhost or the loop back address 127.0.0.1. You might have guessed it already. The application is deployed onto a device or an Android emulator. It is the device that takes the localhost IP not the development machine. To resolve this, I have used the IP address as per my machine&#39;s network configuration.</p>

<p><strong>Line 10:</strong> It is a rest call to the web-service url. Please notice that it is a HTTP GET request as indicated by the name getForObject(). I have specified the String.class as the second argument to the method which means the data returned is to be interpreted as String data.</p>

<p>The method supported by the <strong>RestTemplate</strong> are listed below [code language=&quot;java&quot; light=&quot;true&quot;] HTTP RestTemplate DELETE delete(String, String...) GET getForObject(String, Class, String...) HEAD headForHeaders(String, String...) OPTIONS optionsForAllow(String, String...) POST postForLocation(String, Object, String...) PUT put(String, Object, String...) 
 ``` But, when I try to run this code I get an exception</p>

<p>[sourcecode language=&quot;java&quot; light=&quot;true&quot;] no suitable HttpMessageConverter found for response type [com.xebia.android.Project] and content type [application/json] [/sourcecode] That&#39;s because we are not dealing with text data here but JSON data type</p>

<p>Making this work requires few changes to our activity class. Below are the changes to be made [sourcecode language=&quot;java&quot;] public class DefaultActivity extends Activity { /*_ Called when the activity is first created. _/ @Override public void onCreate(Bundle savedInstanceState) { ... RestTemplate restTemplate = <strong>getRestTemplate()</strong>; JSONData[] jsonData = restTemplate.getForObject(url,ProjectData[].class); ... }</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">private RestTemplate getRestTemplate() {
    RestTemplate restTemplate = new RestTemplate();
    restTemplate.setRequestFactory(new CommonsClientHttpRequestFactory());
    &amp;lt;strong&amp;gt;MappingJacksonHttpMessageConverter jsonConverter = 
                            new MappingJacksonHttpMessageConverter();
    List&amp;lt;MediaType&amp;gt; supportedMediaTypes = new ArrayList&amp;lt;MediaType&amp;gt;();
    supportedMediaTypes.add(new MediaType(&amp;quot;application&amp;quot;,&amp;quot;json&amp;quot;));
    jsonConverter.setSupportedMediaTypes(supportedMediaTypes);&amp;lt;/strong&amp;gt;

    List&amp;lt;HttpMessageConverter&amp;lt;?&amp;gt;&amp;gt; listHttpMessageConverters = restTemplate
            .getMessageConverters();
    restTemplate.setMessageConverters(listHttpMessageConverters);
    return restTemplate;
}
</code></pre></div>
<p>[/sourcecode]</p>

<p>To handle the JSON array data the response should be understandable by the restTemplate.</p>

<p>As such, in the code above I have registered a ** MappingJacksonHttpMessageConverter **with the restTemplate so as to read and write JSON data. </p>

<p>Also, we need to convey what sort of data our converter can handle e.g. text, xml, jpeg, json etc. This is done by defining a supported <strong>MediaType</strong> which in our case is MediaType(&quot;application&quot;,&quot;json&quot;)</p>

<p>You may have noticed that the second argument to the getForObject method in the code above is changed from String.class to ProjectData.class. This is because the messageCoverters for JSON and the mediaType which our converter can handle have been implemented. We can now safely state that the response from the web service is an array of ProjectData.</p>

<p>Here&#39;s our *<em>Android client *</em>side class representing Project data</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> @JsonIgnoreProperties( {&quot;class&quot; }) public class JSONData { private String name; private Integer id; private String owner; private Issue[] issues; … //getter and setters for all … } 
</code></pre></div>
<p>here, JsonIgnoreProperties annotation conveys the JSON mapper that these are the properties to be excluded. The JSON response contains a class variable which I am ignoring in the code above. [sourcecode language=&quot;java&quot;] {&quot;class&quot;:&quot;com.xyz.Project&quot;,&quot;id&quot;:1,&quot;issues&quot;:[],&quot;name&quot;:&quot;TestProject0&quot;,&quot;owner&quot;:&quot;Test0&quot;} [/sourcecode]</p>

<p>Please note that issues property is declared as an array. This is because with JSON it&#39;s easier to work with arrays.</p>

<p>Note: I was getting *<em>java.lang.VerifyError *</em> when I tried to run the application in my environment and after including jackson-core-asl-1.6.1.jar and jackson-mapper-asl-1.6.1.jar everything seems to be working fine.</p>

<h2>Comments</h2>

<p><strong><a href="#4709" title="2011-01-05 12:12:28">Wilfred Springer</a>:</strong> Hi Yogesh, What is not totally clear to me yet is to what extent any of this depends on the core Spring libraries. I could easily imagine that depending on full Spring would be impossible, because of Spring&#39;s memory footprint. At TomTom, we worked on a tiny implementation of Spring as well, in the past. You can find all about it here: http://springframework.me/. It basically provides Spring dependency injection to Java platforms normally not supported, because of limitations in the runtime. (Like no support for reflection, or limited resources.) I would love to see if we could sort of combine it. I have seen references to people using Spring ME on Android. In all honesty, there hasn&#39;t been any real work on Spring ME in two years, but the basic idea still holds, which is that using Spring ME you can have Spring dependency injection with a 0kb runtime footprint.</p>

<p><strong><a href="#4710" title="2011-01-05 12:18:54">Jojo</a>:</strong> That&#39;s just what I need on a phone...a better logging framework! Methinks someone&#39;s head is stuck in server-land. For God&#39;s sake, it&#39;s a phone! Why would I want either logging (any at all - where will it go?!) or a framework that forces me to write half my code in XML (parsing is not cheap, and structure is at least half of <em>why</em> you have objects!!!) on a phone? There are things in life which you could do, but should not. This is one of those.</p>

<p><strong><a href="#4737" title="2011-01-06 11:09:30">Yogesh Kapoor</a>:</strong> I fully concur with Keith&#39;s thoughts. Even the blog tries to suggest this. Thank you Keith for bringing in more clarity. If you need any further clarifications please let me know.</p>

<p><strong><a href="#4779" title="2011-01-07 09:48:32">emaggini</a>:</strong> Wow, This is pretty great thanks for the article. The more I learn about Spring the more I like. :)</p>

<p><strong><a href="#4733" title="2011-01-06 08:46:04">Keith Donald</a>:</strong> Guys, Thus far, as a project Spring Android has a pretty simple goal: ensure relevant Spring client libraries work well in an Android environment. This starts with RestTemplate as a popular HTTP client, which is important any Android app that requires the network The commons logging adapter is useful because it allows existing code that depends on the commons logging API to work in an Android environment by delegating to Android&#39;s on logging framework underneath. That is all. There&#39;s no XML in Spring Android, and we&#39;re not trying to change the way people develop Android-based business applications. We simply want to make Spring client libraries accessible to Android developers and want to make it as easy as possible for folks to get started when Android is the right choice for them. Yogesh, thanks for writing this entry and getting the word out about the project! Watch for subsequent milestones to become available on a regular basis. Keith</p>

<p><strong><a href="#4734" title="2011-01-06 08:52:45">Keith Donald</a>:</strong> Wilfred, Interesting idea. Where would you recommend the Spring Android team start with a review of Spring ME? Feel free to DM me and we can setup a Skype to discuss your approach and how you could see it being applied in an Android environment. Thanks! Keith Twitter: @kdonald</p>

<p><strong><a href="#5124" title="2011-01-28 07:42:55">Daniel</a>:</strong> OK, I read until the end, and it worked fine by adding the two mentioned libraries: jackson-core-asl-1.6.1.jar and jackson-mapper-asl-1.6.1.jar For some reason, I needed to remove spring-android-commons-logging-1.0.0.M1.jar for the project to compile (Dalvik compilation issue). Great tutorial!!!!</p>

<p><strong><a href="#5100" title="2011-01-28 03:46:26">Daniel</a>:</strong> Thanks for the tutorial. However, I cannot complete it because I cannot find @JsonJsonIgnoreProperties ...</p>

<p><strong><a href="#5102" title="2011-01-28 03:49:25">Daniel</a>:</strong> ok I guess it&#39;s a question of adding another library. Will try. Thx</p>

<p><strong><a href="#5917" title="2011-09-15 20:42:33">Rocky</a>:</strong> I am getting the following error after adding two jars : jackson-core-asl-1.6.1.jar and jackson-mapper-asl-1.6.1.jar, I am getting following error 09-15 20:59:08.828: INFO/dalvikvm(383): Could not find method org.codehaus.jackson.map.ObjectMapper.getTypeFactory, referenced from method org.springframework.http.converter.json.MappingJacksonHttpMessageConverter.getJavaType anyhelp ?</p>

<p><strong><a href="#5918" title="2011-09-15 20:46:21">Rocky</a>:</strong> I am getting the floowing exception after adding the two jars jackson-core-asl-1.6.1.jar and jackson-mapper-asl-1.6.1.jar, exception : INFO/dalvikvm(383): Could not find method org.codehaus.jackson.map.ObjectMapper.getTypeFactory, referenced from method org.springframework.http.converter.json.MappingJacksonHttpMessageConverter.getJavaType</p>

<p><strong><a href="#9041" title="2012-06-15 13:37:19">Rohit</a>:</strong> Hi, i m new for Android. i am working in java/j2EE, I have seen there is spring support in Android at client side(Message Convertor,SQLite) , but i am not getting any good resource, So If you have any resource or sample code , can you please send me on my gmail id? my gmail id is javahunterAnd@gmail.com</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2010/12/31/speech-to-text-conversion-in-java-2/" data-toggle="tooltip" data-placement="top" title="Speech To Text Conversion In Java 2">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2010/12/31/spring-integration-configuring-mail-replier-adapter/" data-toggle="tooltip" data-placement="top" title="Spring Integration Configuring Mail Replier Adapter">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
