<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Localization In Tapestry - Xebia Blog</title>

    <link rel="canonical" href="http://xebia.com/2010/07/08/localization-in-tapestry/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Localization In Tapestry</h1>
                    
                    <span class="meta">Posted by sprasadjha on July 8, 2010</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<h1>Localization in Tapestry</h1>

<p>In my current project I have been assigned the task of internationalizing the application. The application is using Tapestry as the MVC framework. In the process of localization I came across a number of technical hurdles for which I had to Google, read some books or consult other developers to find a solution. In this blog I intend to capture all such details which I found, some times easily and sometimes with a bit of effort. I would begin with brief discussion of basics and then deal with specific cases and their solutions.</p>

<p> </p>

<h1>Localization in Tapestry 5</h1>

<p> </p>

<h4>Step 1: Enable multi-lingual support :</h4>

<p>Tapestry needs to be informed about the languages it needs to support. If the application supports English, French and German then contributeApplicationDefaults method of the AppModule class should have following code</p>

<p>[sourcecode language=&quot;java&quot;] public static void contributeApplicationDefaults( MappedConfiguration configuration){ configuration.add(&quot;tapestry.supported-locales&quot;, &quot;en,fr,de&quot;); } [/sourcecode] </p>

<h4>Step 2: Create locale specific property files</h4>

<p>Create properties files for each language that application supports. For all languages which application does not support create a default property file which would be used to render the GUI in default language used to create the  default property file.</p>

<p> </p>

<p>The conventions to be followed are as follows</p>

<ol>
<li><p>If page/component is PageName.tml create PageName.properties. This will be treated as the default property file.</p></li>
<li><p>Create PageName<em>fr.properties and PageName</em>de.properties (to support French and German).</p></li>
<li><p>Place the properties files in the same package as the tml&#39;s java file (PageName.java in this case).</p></li>
</ol>

<p> </p>

<p>Note: It is a good practice to place the properties files along with resources and not with .java files. This makes it easy to manage the properties files. The resources can be easily given to ( generally ) non technical guys for translation.</p>

<h4>Step 3: Use the locale keys in tml files</h4>

<p>In the .tml files replace the strings that need to be localized with the following construct.</p>

<p> </p>

<p>[sourcecode language=&quot;xml&quot;] ${message:key.in.proprties.file} [/sourcecode] </p>

<p>Tapestry framework will take care of replacing the key with appropriate localized value.</p>

<p> </p>

<h4>Specific Cases : Questions &amp; Answers</h4>

<p>The above mentioned steps are the basic building blocks required to equip Tapestry to support i18n. But there are specific cases which require special attention. I will deal them as questions and answers</p>

<h5>How to define commonly used strings in one properties file?</h5>

<p>There will be some strings which get repeated number of times in the application. If you follow the steps detailed above then the common keys will get repeated in more than one properties files. To overcome this problem, in Tapestry there is a concept of application-wide or root message catalog. There are two conventions which needs to be followed for creating root message catalog</p>

<ol>
<li><p>Place the file in WEB-INF directory.</p></li>
<li><p>The name of the file should be same as the name of the Tapestry filter defined in the web.xml file. If the definition in web.xml is as follows then the name the root message catalog should be app.properties.</p></li>
</ol>

<p> </p>

<p>[sourcecode language=&quot;xml&quot;] app com.abc.xyz.lmnFilter [/sourcecode] </p>

<p> </p>

<h5>How to create parameterized message key?</h5>

<p> </p>

<p>While deleting an entity an alert should appear with a message “You are about to delete entity <Entity Name>. Are you sure ?” How can I create a single key for such messages?</p>

<p> </p>

<p>Instead of breaking this message into two parts and creating two keys for the message a single key can be created, as follows:</p>

<p>Entry in properties file</p>

<p> </p>

<p>[sourcecode language=&quot;xml&quot;] confirm.delete.key=You are about to delete entity &#39;%s&#39;. Are you sure ? [/sourcecode] </p>

<p> </p>

<p>Entry in the tml</p>

<p> </p>

<p>[sourcecode language=&quot;xml&quot;] ${format:confirm.delete.key=deleteEntityName} [/sourcecode] </p>

<p> </p>

<p>The above command will pull the value of the key from the message bundle and will call getDeleteEntityName() method of the tml&#39;s java file and then replace the &#39;%s&#39; in the message string with the value returned by the method.</p>

<p> </p>

<p> </p>

<h5>How to localize the default validation and error messages of the tapestry framework?</h5>

<p> </p>

<p>Tapestry places the default error message catalog in org.apache.tapestry5.corelib.components package. By default Tapestry supports some languages like French, German etc. To add default error message support for a new language add a message catalog in org.apache.tapestry.internal package. The name of the default message catalog file is Errors.properties. You can create the locale specific version of the error messages as described in step 2 above.</p>

<p> </p>

<p>Similarly to localize the validation messages you most add a message catalog in org.apache.tapestry.internal package. The message catalog name is ValidationMessages.properties.</p>

<p> </p>

<p>To create localized files one needs to know the key names in the localized files. To do that you can look the content of the file in jar.</p>

<p>To put this message catalog in package other than default package add following code to contributeValidationMessagesSource(Configuration<String> configuration) :</p>

<p>[sourcecode language=&quot;java&quot;] public void contributeValidationMessagesSource(Configuration configuration) { configuration.add(&quot;path/to/your/package/ValidationMessages.properties&quot;); } [/sourcecode]</p>

<h2>Comments</h2>

<p><strong><a href="#8404" title="2012-04-09 20:51:32">Nuno Monteiro</a>:</strong> Hello, I&#39;m trying to internationalize my webapp that was built using Tapestry 5. I have lots of parameterized messages. So I&#39;m trying to use what you describe on step &quot;How to create parameterized message key?&quot;. However, when I use the format: binding expression I receive this error: Could not convert &#39;format:welcome-message=myName&#39; into a component parameter binding: Error parsing property expression &#39;format:welcome-message=myName&#39;: line 1:6 missing EOF at &#39;:&#39;. I have myName as a page @Property and I have the welcome-message key in the page catalog. Tapestry do not recognize the format: as it recognize the message: parameter binding. Can you help me, please? Thank you, Nuno Can you help me?</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2010/07/01/localization-of-javascript-messages-in-tapestry/" data-toggle="tooltip" data-placement="top" title="Localization Of Javascript Messages In Tapestry">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2010/07/09/e-commerce-business-models/" data-toggle="tooltip" data-placement="top" title="E Commerce Business Models">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
