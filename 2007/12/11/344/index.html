<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>344 - Xebia Blog</title>

    <link rel="canonical" href="http://blog.xebia.in/2007/12/11/344/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>344</h1>
                    
                    <span class="meta">Posted by sunil.inteti on December 11, 2007</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        <div class="row">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=shekhargulati" async="async"></script>

            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <h4>Reading time about 5  minutes</h4>

              <h1>Security Protocols and common attacks.</h1>

<p>I wanted to write a blog on Security Protocols. This was the course I liked the most during my College days. Lets look at some protocols and some of the ways these protocols can be attacked. These are some protocols that i studied during my college days.</p>

<p>The two most common words in Security world is Confidentiality and Integrity. Understanding these two terms is very crucial. In simple words Confidentiality means that only authorized entities can read information. Integrity means reassuring the recipient of the message that the message has not been altered since it was generated by a legitimate source. In Public Key Cryptography ---Each user U has an encryption function Euthat is made public. ---Each user U has a decryption function (key) Du that is non-public. Du(Eu(m)) = m The encryption function Eu can be revealed without revealing the decryption function Du As we Know Confidentiality can be provided by Encryption . Integrity can be provided by using digital signatures.</p>

<p>Lets plunge into some example protocol with the famous Alice and Bob example. Now lets look at a session establishment protocol and some attacks on it. A protocol to establish a session key K between Alice and Bob must guarantee the following two properties.</p>

<p>After successful protocol execution: </p>

<ul>
<li>Only Alice and Bob (and TTP&#39;s involved if any. TTP is a trusted third party involved in generation of a session key) should know K. Alice and Bob should be assured that K is newly generated.</li>
</ul>

<p>An Adversary can do the any of the following</p>

<ul>
<li>Eavesdrop on all messages sent in a protocol Alter all messages sent in a protocol using any information available Re-route any message to any principal Generate and insert completely new messages Obtain the value of the session key used in any sufficiently old previous run of the protocol Start any number of parallel protocol runs between any principals.</li>
</ul>

<p>Some Encryption assumptions are involved in Encryption. The encryption of message M with key K (shared or public) is denoted by ciphertext {M}K</p>

<p>Assumptions: </p>

<ul>
<li>Without K or matching private key, it should be impossible to retrieve M from {M}K It should be impossible to retrieve K or matching private key from {M}K Without K even with knowledge of M it should be impossible to alter {M}Kwithout being detected </li>
</ul>

<p>Here is what the notations used in this blog mean {K}KAT --- K is encrypted with shared key between Alice and Trent. KAT is known to both Alice and Trent.</p>

<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/1.gif" alt="1.gif"></p>

<p>Here Trent is the trusted third party. In the first step Alice sends a message to Trent saying that it wants to have a session with Bob. Trent finds keys KAT , KBT, generates K at random, creates {K}AT , {K}BT which are the shared keys between Alice and Trent, Bob and Trent respectively. Alice decrypts {K}KAT to get K.. Bob decrypts {K}KBT to get K. And from now on Alice and Bob can communicate with key K. Now lets look at the attack on this protocol. <img src="http://xebee.xebia.in/wp-content/uploads/2007/12/2.gif" alt="2"></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;ul&gt;
</code></pre></div>
<ul>
<li>Mallory(one who tries to break rules,may be a valid principal ) intercepts Alice’s message intended for Trent.</li>
</ul>

<p>Trent thinks Alice wants key with Mallory.</p>

<p>Alice is fooled that Mallory is Bob.</p>

<p>Attacker is (also) a legitimate principal.</p>

<p>Here Mallory impersonates as Bob and Alice is made to believe it. </p>

<p>FIX FOR THE ATTACK:</p>

<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/3.gif" alt="3"></p>

<p>This protocol binds the session key to the intended users</p>

<p>If Mallory tries the previous attack, then Trent will include Mallory’s identity in the encrypted part intended for Alice, so she knows the decrypted key is not shared with Bob and therefore the attack will fail</p>

<p>YET ANOTHER ATTACK ON THIS IMPROVED PROTOCOL</p>

<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/4.gif" alt="4"></p>

<p>Mallory records exchange between Alice and Bob as shown in the above figure.</p>

<p>Mallory replays messages in subsequent run like in the second step of the protocol</p>

<p>Here are some points to note</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;ul&gt;
</code></pre></div>
<ul>
<li>K’ is a not fresh</li>
</ul>

<p>But Alice does not know about this.</p>

<p>K’ is known to Mallory. And Mallory can again fool Alice.</p>

<p>This attack is called a replay/freshness attack. </p>

<p>The fix here is to challenge and expect a response so that No one can play replay attacks.</p>

<p>So here is the improved protocol</p>

<p><img src="http://xebee.xebia.in/wp-content/uploads/2007/12/5.gif" alt="5"></p>

<p>Alice (Bob) checks if Trent is there</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;ul&gt;
</code></pre></div>
<ul>
<li>Sends random challenge to Trent</li>
</ul>

<p>Trent responds with a message that binds the challenge to the session key as you can see in the second step of the new protocol above.</p>

<p>Alice (Bob) verify the binding before accepting the key</p>

<p>Since Alice (Bob) expects a different response each time, Mallory cannot replay an old response without detection</p>

<p>This method is called challenge-response.</p>

<p>NA is called the nonce and its the challenge sent by Alice to Trent and trent responds for it. So a reply is always a fresh one. Now mallory canont replay the messages like it could in the previos version of the protocol.</p>

<p>This brand new protocol includes 2 challenge response exchanges. One is between Alice an Trent and other is between Bob and Alice.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&lt;ul&gt;
</code></pre></div>
<ul>
<li>Bob checks if Alice is there</li>
</ul>

<p>Sends challenge to A (Message 4)</p>

<p>Response should be fresh (Message 5)</p>

<p>Friends unfortunately there is another attack on this improved protocol as well. Can You guess it???!!!!! [:)]</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2007/12/09/static-code-analysis-is-just-tip-of-the-iceberg/" data-toggle="tooltip" data-placement="top" title="Static Code Analysis Is Just Tip Of The Iceberg">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2007/12/31/introducing-android-mobile-is-the-future/" data-toggle="tooltip" data-placement="top" title="Introducing Android Mobile Is The Future">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58958750-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
