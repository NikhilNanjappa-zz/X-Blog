<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Thoughts on latest technologies">

    <title>Customizing Angular Directives - Xebia Blog</title>

    <link rel="canonical" href="http://blog.xebia.in/2014/11/26/customizing-angular-directives/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Xebia Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/default-blog-pic.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Customizing Angular Directives</h1>
                    
                    <span class="meta">Posted by brijesh pant on November 26, 2014</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">

        <div class="row">
          <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=shekhargulati" async="async"></script>

            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
              <h4>Reading time about 3  minutes</h4>

              <h1>Customizing Angular Directives</h1>

<p>While developing Angular Application we have a obvious choice of using third party directives. Most of the time these directive are suffice to handle all the use cases. But situation may occur when you feel that there is really something missing to fulfill your Specific problem. Common practice is to add your own custom directive along with the directive, you want to use in the element. But It sounds quite weired to Have two directives to solve the same problem. Hence we might have to think of some different way.</p>

<p>In this Post i will share one of the Scenerio in above said category and solution to that of-course.</p>

<p><strong>Scenario:</strong></p>

<p>Let us take an example of uibootstrap datepicker-popup directive to show the datepicker. This directive can be used in HTML like this</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> [input type=&quot;text&quot; class=&quot;form-control&quot; datepicker-popup=&quot;&quot; 
      ng-model=&quot;date&quot; data-show-button-bar=&quot;false&quot; data-datepicker-mode =&quot;mode&quot; is-open=&quot;opened&quot; close-text=&quot;Close&quot;]
</code></pre></div>
<p>It will do pretty much all the jobs one can expect from the date picker. As per the requirements you can add more options available with this directive. You might use this date picker in several places across your application. Most of the time you will find same configuration. For this you will be repeating the same piece of code again and again. I don&#39;t really like this and sure you as well.</p>

<p>There is one more scenario. Your back end API gives you date in different format than what you have to display in the GUI and similarly you have to send back to API in different format. For this we have to first change the date string to date before passing to the directive. And also change the date before sending back to back end API. Again you are going to do it in every controller managing the HTML.</p>

<p>To handle both the above cases we can write a custom directive that will internally use the datepicker-popup directive. We will provide all the options in custom directive and then this can be used every where else.</p>

<p>Here is the example</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">directive(&#39;CustomDatepicker&#39;, function ($compile, $filter) {
         return {
             restrict: &#39;A&#39;,
             scope   : {
                   CustomDatepicker: &quot;=&quot;
             },
             link    : function ($scope, element) {
               $scope.mode = &quot;year&quot;;
               var timestamp = Date.parse($scope.CustomDatepicker);
               if (!isNaN(timestamp)) {
                   $scope.date = new Date(timestamp);
               }

               element.attr(&#39;data-datepicker-popup&#39;, &quot;dd-MM-yyyy&quot;);
               element.attr(&#39;data-ng-model&#39;, &#39;date&#39;);
               element.attr(&#39;data-is-open&#39;, &#39;datePicker.open&#39;);
               element.attr(&#39;data-show-button-bar&#39;, false);
               element.attr(&#39;data-ng-click&#39;, &#39;datePicker.open = true&#39;);
               element.attr(&#39;data-datepicker-mode&#39;, &#39;mode&#39;);
               element.removeAttr(&quot;data-custom-datepicker&quot;);
               $scope.$evalAsync(function (scope) {
                   $compile(element)(scope);
             });

             $scope.$watch(&#39;date&#39;, function () {
               if ($scope.date) {
                   $scope.customDatepicker = $filter(&#39;date&#39;)($scope.date, &quot;yyyy-MM-dd&quot;);
               }
             });

         }
        };
      });
    });
</code></pre></div>
<p><strong>Explanation:</strong></p>

<p>In the custom directive i have defined the scope variable customDatepicker that holds the date value as received by your controller. Now change this date string to proper date </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var timestamp = Date.parse($scope.customDatepicker);
if (!isNaN(timestamp)) {
$scope.date = new Date(timestamp);
}
</code></pre></div>
<p>Now we will add datepicker and all of the other options that we needed. This can be done using attr method of the element. </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">element.attr(&#39;data-datepicker-popup&#39;, &quot;dd-MM-yyyy&quot;);
element.attr(&#39;data-ng-model&#39;, &#39;date&#39;);
element.attr(&#39;data-is-open&#39;, &#39;datePicker.open&#39;);
element.attr(&#39;data-show-button-bar&#39;, false);
element.attr(&#39;data-ng-click&#39;, &#39;datePicker.open = true&#39;);
element.attr(&#39;data-datepicker-mode&#39;, &#39;mode&#39;);
</code></pre></div>
<p>Remove custom-datepicker as it is no longer needed. element.removeAttr(&quot;data-custom-datepicker&quot;); to apply the DOM changes in the link function add following lines </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$scope.$evalAsync(function (scope) {
$compile(element)(scope);
});
</code></pre></div>
<p>it will update the DOM in next digest cycle. Finally as we have bind different scope variable with the date picker, our original scope variable remain unchanged. So we need this to be updated . To achieve this we will add watch on date And update the customDatepicker whenever date will be changed </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$scope.$watch(&#39;date&#39;, function () {
if ($scope.date) {
$scope.customDatepicker = $filter(&#39;date&#39;)($scope.date, &quot;yyyy-MM-dd&quot;);
}
});
</code></pre></div>
<p>In the HTML we just have to add following code </p>
<div class="highlight"><pre><code class="language-text" data-lang="text">[input type=&quot;text&quot; data-custom-datepicker=&quot;input.date&quot;]
</code></pre></div>
<p>This will implicitly add date-picker and all the associated options.Also you need not to worry for the date format in every controller. Date format that will be displayed is dd-MM-yyyy and the output format will be yyyy-MM-dd. Similarly you can customize your other directives as well. Happy coding....</p>


                <hr>

                <div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'xebiaww'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2014/11/26/alfresco-working-with-aspects-in-cmis/" data-toggle="tooltip" data-placement="top" title="Alfresco Working With Aspects In Cmis">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2014/12/03/quick-steps-have-a-kafka-cluster-up-running-in-3-minutes/" data-toggle="tooltip" data-placement="top" title="Quick Steps Have A Kafka Cluster Up Running In 3 Minutes">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="https://twitter.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://www.facebook.com/XebiaIndia">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a href="https://github.com/xebiaww">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Xebia Blog 2015</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-58958750-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

</html>
